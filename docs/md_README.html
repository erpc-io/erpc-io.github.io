<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p class="">eRPC is a fast and general-purpose RPC library for datacenter networks. Our NSDI 2019 <a href="http://www.cs.cmu.edu/~akalia/doc/nsdi19/erpc_nsdi19.pdf">paper</a> describes the system in detail. <a href="http://www.cs.cmu.edu/~akalia/erpc_doc">Documentation</a> is available online.</p>
<p class="">Some highlights:</p><ul>
<li>Multiple supported networks: Ethernet, InfiniBand, and RoCE</li>
<li>Low latency: 2.3 microseconds round-trip RPC latency with UDP over Ethernet</li>
<li>Performance for small 32-byte RPCs: ~10M RPCs/sec with one CPU core, 60&ndash;80M RPCs/sec with one NIC.</li>
<li>Bandwidth for large RPC: 75 Gbps on one connection (one CPU core at server and client) for 8 MB RPCs</li>
<li>Scalability: 20000 RPC sessions per server</li>
<li>End-to-end congestion control that tolerates 100-way incasts</li>
<li>Nested RPCs, and long-running background RPCs</li>
<li>A port of <a href="https://github.com/willemt/raft">Raft</a> as an example. Our 3-way replication latency is 5.3 microseconds with traditional UDP over Ethernet.</li>
</ul>
<h2>Requirements</h2>
<ul>
<li>Toolchain: A C++11 compiler and CMake 2.8+</li>
<li>See <code>scripts/packages/</code> for required software packages for your distro. Install <em>exactly one</em> of the following, mutually-incompatible packages:<ul>
<li>Mellanox OFED for Mellanox NICs</li>
<li>System-wide DPDK for other, DPDK-compatible NICs</li>
</ul>
</li>
<li>NICs: Fast (10 GbE+) bare-metal NICs are needed for good performance. eRPC works best with Mellanox Ethernet and InfiniBand NICs. Any DPDK-capable NICs also work well. Slower/virtual NICs can still be used for testing and development.</li>
<li>System configuration:<ul>
<li>At least 1024 huge pages on every NUMA node, and unlimited SHM limits</li>
<li>On a machine with <code>n</code> eRPC processes, eRPC uses kernel UDP ports <code>{31850, ..., 31850 + n - 1}.</code> These ports should be open on the management network. See <code>scripts/firewalld/erpc_firewall.sh</code> for systems running <code>firewalld</code>.</li>
</ul>
</li>
</ul>
<h2>eRPC quickstart</h2>
<ul>
<li>Build and run the test suite: <code>cmake . -DPERF=OFF -DTRANSPORT=infiniband; make -j; sudo ctest</code>.<ul>
<li><code>DPERF=OFF</code> enables debugging, which greatly reduces performance. Set <code>DPERF=ON</code> for performance measurements.</li>
<li>Here, <code>infiniband</code> should be replaced with <code>raw</code> for Mellanox Ethernet NICs, or <code>dpdk</code> for Intel Ethernet NICs.</li>
<li>A machine with two ports is needed to run the unit tests if DPDK is chosen. Run <code>scripts/run-tests-dpdk.sh</code> instead of <code>ctest</code>.</li>
</ul>
</li>
<li>Run the <code>hello_world</code> application:<ul>
<li><code>cd hello_world</code></li>
<li>Edit the server and client hostnames in <code>common.h</code></li>
<li>Based on the transport that eRPC was compiled for, compile <code>hello_world</code> using <code>make infiniband</code>, <code>make raw</code>, or <code>make dpdk</code>.</li>
<li>Run <code>./server</code> at the server, and <code>./client</code> at the client</li>
</ul>
</li>
<li>Generate the documentation: <code>doxygen</code></li>
</ul>
<h2>Supported bare-metal NICs:</h2>
<ul>
<li>Ethernet/UDP mode:<ul>
<li>ConnectX-4 or newer Mellanox Ethernet NICs: Use <code>DTRANSPORT=raw</code></li>
<li>DPDK-compatible NICs that support flow-director: Use <code>DTRANSPORT=dpdk</code><ul>
<li>Intel 82599 and Intel X710 NICs have been tested</li>
<li>Virtual NICs have not been tested</li>
<li><code>raw</code> transport is faster for Mellanox NICs, which also support DPDK</li>
</ul>
</li>
<li>ConnectX-3 Ethernet NICs are supported in eRPC's RoCE mode</li>
</ul>
</li>
<li>RDMA (InfiniBand/RoCE) NICs: Use <code>DTRANSPORT=infiniband</code>. Add <code>DROCE=on</code> if using RoCE.</li>
<li>Mellanox drivers optimized specially for eRPC are available in the <code>drivers</code> directory</li>
</ul>
<h2>Running eRPC without fast bare-metal NICs:</h2>
<ul>
<li>Follow these instructions to try out eRPC on a machine without fast Mellanox or DPDK-capable NICs (e.g., on your desktop or in a virtual machine). This is for development only: eRPC is not designed to perform well in these settings. eRPC has been tested on KVM virtual machines and in Amazon EC2.</li>
<li>Create an emulated RoCE device with [SoftRoCE] (instructions soon).</li>
<li>Compile eRPC with <code>DTRANSPORT=infiniband -DROCE=on</code></li>
</ul>
<h2>Configuring and running the provided applications</h2>
<ul>
<li>The <code>apps</code> directory contains a suite of benchmarks and examples. The instructions below are for this suite of applications. eRPC can also be simply linked as a library instead (see <code>hello_world/</code> for an example).</li>
<li>To build an application, create <code>scripts/autorun_app_file</code> and change its contents to one of the available directory names in <code>apps/</code>. See <code>scripts/example_autorun_app_file</code> for an example. Then generate a Makefile using <code>cmake . -DPERF=ON -DTRANSPORT=raw/infiniband/dpdk</code>.</li>
<li>Each application directory in <code>apps/</code> contains a config file that must specify all flags defined in <code>apps/apps_common.h</code>. For example, <code>num_processes</code> specifies the total number of eRPC processes in the cluster.</li>
<li>The URIs of eRPC processes in the cluster are specified in <code>scripts/autorun_process_file</code>. Each line in this file must be <code>&lt;hostname&gt; &lt;management udp port&gt; &lt;numa_node&gt;</code>. See <code>scripts/gen_autorun_process_file.sh</code> for how to generate this file.</li>
<li>Run <code>scripts/do.sh</code> for each process:<ul>
<li>With single-CPU machines: <code>num_processes</code> machines are needed. Run <code>scripts/do.sh &lt;i&gt; 0</code> on machine <code>i</code> in <code>{0, ..., num_processes - 1}</code>.</li>
<li>With dual-CPU machines: <code>num_machines = ceil(num_processes / 2)</code> machines are needed. Run <code>scripts/do.sh &lt;i&gt; &lt;i % 2&gt;</code> on machine i in <code>{0, ..., num_machines - 1}</code>.</li>
</ul>
</li>
<li>To automatically run an application at all processes in <code>scripts/autorun_process_file</code>, run <code>scripts/run-all.sh</code>. Application statistics generated in a run can be collected using <code>scripts/proc-out.sh</code>.</li>
</ul>
<h2>Getting help</h2>
<ul>
<li>GitHub issues are preferred over email. Please include the following information in the issue:<ul>
<li>NIC model</li>
<li>Mellanox OFED or DPDK version</li>
<li>Operating system</li>
</ul>
</li>
</ul>
<h2>Contact</h2>
<p class="">Anuj Kalia (<a href="#" onclick="location.href='mai'+'lto:'+'aka'+'li'+'a@c'+'s.'+'cmu'+'.e'+'du'; return false;">akali<span style="display: none;">.nosp@m.</span>a@cs<span style="display: none;">.nosp@m.</span>.cmu.<span style="display: none;">.nosp@m.</span>edu</a>)</p>
<h2>License</h2>
<p class="">Copyright 2018, Carnegie Mellon University</p>
<p class="">Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at </p><pre class="fragment">http://www.apache.org/licenses/LICENSE-2.0
</pre><p class="">Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
